# DO NOT EDIT THIS FILE !				-*-shell-script-*-
#
# @configure_input@ 
# on @DATE@
#

# basics
exec_prefix=@exec_prefix@

# params from the flavor executable
FLAVOR=`flavor`
MODULE_EXT=`flavor -m`
BUILD_SYS=`flavor -b`

# A few parameters from emc2/Makefile.inc
EMC2_HOME=@EMC2_HOME@
RTLIB_DIR=@EMC2_RTLIB_DIR@/$FLAVOR
USE_PORTABLE_PARPORT_IO=@USE_PORTABLE_PARPORT_IO@
TARGET_PLATFORM=@TARGET_PLATFORM@
ARCHITECTURE=@ARCHITECTURE@
GIT_VERSION=@GIT_VERSION@
RUN_IN_PLACE=@RUN_IN_PLACE@
PIDOF=@PIDOF@

# shared memory kernel driver
USE_SHMDRV=@USE_SHMDRV@

# fixme make param
HAL_SIZE=512000

# Sets the default DEBUG level
DEBUG='1'

# flavor in UPPER_CASE_WITH_UNDERSCORES
FLAVOR_UP=`echo $FLAVOR|tr a-z- A-Z_`

# run-in-place rtapi module directory
POSIX_THREADS_RIP_MODULE_DIR=@POSIX_THREADS_RIP_MODULE_DIR@
RT_PREEMPT_THREADS_RIP_MODULE_DIR=@RT_PREEMPT_THREADS_RIP_MODULE_DIR@
XENOMAI_THREADS_RIP_MODULE_DIR=@XENOMAI_THREADS_RIP_MODULE_DIR@
RTAI_KERNEL_THREADS_RIP_MODULE_DIR=@RTAI_KERNEL_THREADS_RIP_MODULE_DIR@
XENOMAI_KERNEL_THREADS_RIP_MODULE_DIR=@XENOMAI_KERNEL_THREADS_RIP_MODULE_DIR@
eval "RIP_MODULE_DIR=\${${FLAVOR_UP}_THREADS_RIP_MODULE_DIR}"

# Path to the realtime kernel modules
POSIX_THREADS_MODULE_DIR=@POSIX_THREADS_MODULE_DIR@
RT_PREEMPT_THREADS_MODULE_DIR=@RT_PREEMPT_THREADS_MODULE_DIR@
XENOMAI_THREADS_MODULE_DIR=@XENOMAI_THREADS_MODULE_DIR@
RTAI_KERNEL_THREADS_MODULE_DIR=@RTAI_KERNEL_THREADS_MODULE_DIR@
XENOMAI_KERNEL_THREADS_MODULE_DIR=@XENOMAI_KERNEL_THREADS_MODULE_DIR@
eval "MODULE_DIR=\${${FLAVOR_UP}_THREADS_MODULE_DIR}"

# Choose the actual path to real modules
if test "$RUN_IN_PLACE" = yes; then
    MODPATH=$RIP_MODULE_DIR
else
    MODPATH=$MODULE_DIR
fi

# List of realtime kernel modules to be loaded
if [ "$FLAVOR" = rtai-kernel ] ; then \
    MODULES="rtai_hal rtai_sched rtai_fifos rtai_shm rtai_sem rtai_math"
elif [ "$FLAVOR" = xenomai-kernel ] ; then
    MODULES="xeno_math"
fi

# kernel version for this flavor from config
RTAI_KERNEL_THREADS_RTAPI_KERNEL_VERS=@RTAI_KERNEL_THREADS_RTAPI_KERNEL_VERS@
XENOMAI_KERNEL_THREADS_RTAPI_KERNEL_VERS=@XENOMAI_KERNEL_THREADS_RTAPI_KERNEL_VERS@
eval "KERNEL_VERS=\${${FLAVOR_UP}_THREADS_RTAPI_KERNEL_VERS}"

# set the default instance, if not already set
INSTANCE=`printf '%d' $INSTANCE`
if [ "$INSTANCE_NAME" != "" ]  ; then
    NAME_CMD=--instance_name="$INSTANCE_NAME"
else
    unset NAME_CMD
fi

if [ $RUN_IN_PLACE = yes ]; then
    # When using RIP make sure PATH includes the directory where rtapi_app
    # resides
    PATH=@EMC2_HOME@/bin:$PATH; export PATH
fi


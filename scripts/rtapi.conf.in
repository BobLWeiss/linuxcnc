# DO NOT EDIT THIS FILE !				-*-shell-script-*-
#
# @configure_input@ 
# on @DATE@
#

# basics
exec_prefix=@exec_prefix@
bindir=@bindir@

# paths to executables
flavor=${bindir}/flavor
rtapi_app=${bindir}/rtapi_app
rtapi_msgd=${bindir}/rtapi_msgd

# params from the flavor executable
FLAVOR=`${flavor}`
MODULE_EXT=`${flavor} -m`
BUILD_SYS=`${flavor} -b`

# A few parameters from emc2/Makefile.inc
EMC2_HOME=@EMC2_HOME@
RTLIB_DIR=@EMC2_RTLIB_DIR@
USE_PORTABLE_PARPORT_IO=@USE_PORTABLE_PARPORT_IO@
TARGET_PLATFORM=@TARGET_PLATFORM@
ARCHITECTURE=@ARCHITECTURE@
GIT_VERSION=@GIT_VERSION@
RUN_IN_PLACE=@RUN_IN_PLACE@
PIDOF=@PIDOF@
RTAI_KERNEL_THREADS_RTS=@RTAI_KERNEL_THREADS_RTS@

# shared memory kernel driver
USE_SHMDRV=@USE_SHMDRV@

# fixme make param
HAL_SIZE=512000

# Sets the default DEBUG level
DEBUG='1'

# flavor in UPPER_CASE_WITH_UNDERSCORES
FLAVOR_UP=`echo $FLAVOR|tr a-z- A-Z_`

# Path to kernel modules
if test $RUN_IN_PLACE = yes; then
    MODPATH=$RTLIB_DIR
else
    MODPATH=/lib/modules/`uname -r`/linuxcnc
fi
# RTAI exception (as usual) to module path
test $FLAVOR = rtai-kernel && \
    MODPATH="$MODPATH $($RTAI_KERNEL_THREADS_RTS --module-dir)"

# List of realtime kernel modules to be loaded
if [ "$FLAVOR" = rtai-kernel ] ; then \
    MODULES="rtai_hal rtai_sched rtai_fifos rtai_shm rtai_sem rtai_math"
elif [ "$FLAVOR" = xenomai-kernel ] ; then
    MODULES="xeno_math"
fi
# kernel threads also need the rtapi and hal_lib kernel modules
test $BUILD_SYS = kbuild && MODULES="$MODULES rtapi hal_lib"
# kernel threads and optionally userland threads use shmdrv module
test $BUILD_SYS = kbuild -o $USE_SHMDRV = yes && MODULES="shmdrv $MODULES"

# kernel version to select flavor
KERNEL_VERS=$(uname -r)

# set the default instance, if not already set
INSTANCE=`printf '%d' $INSTANCE`
if [ "$INSTANCE_NAME" != "" ]  ; then
    NAME_CMD=--instance_name="$INSTANCE_NAME"
else
    unset NAME_CMD
fi

if [ $RUN_IN_PLACE = yes ]; then
    # When using RIP make sure PATH includes the directory where rtapi_app
    # resides
    PATH=@EMC2_HOME@/bin:$PATH; export PATH
fi

